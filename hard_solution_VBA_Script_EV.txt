Sub stocks()For Each ws In Worksheetsws.Cells(1, 9).Value = "Ticker"ws.Cells(1, 10).Value = "Yearly Change"ws.Cells(1, 11).Value = "Percent Change"ws.Cells(1, 12).Value = "Total Stock Volume"Dim Summary_Table_Row As IntegerSummary_Table_Row = 2LastRow = ws.Cells(Rows.Count, 1).End(xlUp).RowDim open_row As Longopen_row = 2Total = 0For i = 2 To LastRowIf ws.Cells(i + 1, 1).Value <> ws.Cells(i, 1).Value Then'TickerDim Ticker As StringTicker = ws.Cells(i, 1).Valuews.Range("I" & Summary_Table_Row).Value = Ticker'Yearly ChangeDim open_price As Doubleopen_price = ws.Cells(open_row, 3).Valueopen_row = i + 1Dim close_price As Doubleclose_price = ws.Cells(i, 6).ValueDim Yearly_Change As DoubleYearly_Change = close_price - open_pricews.Range("J" & Summary_Table_Row).Value = Yearly_Change'Percent ChangeDim Percent_Change As DoublePercent_Change = (Yearly_Change / open_price)ws.Range("K" & Summary_Table_Row).Value = Percent_Changews.Range("K" & Summary_Table_Row).Style = "Percent"ws.Range("K" & Summary_Table_Row).NumberFormat = "0.00%"'Total Stock VolumeTotal = Total + ws.Range("G" & i).Valuews.Range("L" & Summary_Table_Row).Value = TotalTotal = 0Summary_Table_Row = Summary_Table_Row + 1ElseTotal = Total + ws.Range("G" & i).ValueEnd IfNext i'Conditional FormattingLastRow_table = ws.Cells(Rows.Count, "I").End(xlUp).RowFor a = 2 To LastRow_tableIf ws.Range("J" & a).Value >= 0 Thenws.Range("J" & a).Interior.ColorIndex = 4ElseIf ws.Range("J" & a).Value < 0 Thenws.Range("J" & a).Interior.ColorIndex = 3ElseEnd IfNext a'Greatest Increase, Decrease, and Total Volumews.Cells(2, 15).Value = "Greatest % Increase"ws.Cells(3, 15).Value = "Greatest % Decrease"ws.Cells(4, 15).Value = "Greatest Total Volume"ws.Cells(1, 16).Value = "Ticker"ws.Cells(1, 17).Value = "Value"Greatest_Inc = 0Greatest_Dec = 0Greatest_Vol = 0For j = 2 To LastRow_tableIf ws.Cells(j + 1, 11).Value > Greatest_Inc ThenGreatest_Inc = ws.Cells(j + 1, 11).Valuews.Cells(2, 17).Value = Greatest_Incws.Cells(2, 16).Value = ws.Cells(j + 1, 9).Valuews.Cells(2, 17).Style = "Percent"ws.Cells(2, 17).NumberFormat = "0.00%"ElseIf ws.Cells(j + 1, 11).Value < Greatest_Dec ThenGreatest_Dec = ws.Cells(j + 1, 11).Valuews.Cells(3, 17).Value = Greatest_Decws.Cells(3, 16).Value = ws.Cells(j + 1, 9).Valuews.Cells(3, 17).Style = "Percent"ws.Cells(3, 17).NumberFormat = "0.00%"ElseIf ws.Cells(j + 1, 12).Value > Greatest_Vol ThenGreatest_Vol = ws.Cells(j + 1, 12).Valuews.Cells(4, 17).Value = Greatest_Volws.Cells(4, 16).Value = ws.Cells(j + 1, 9).ValueElseEnd IfNext jws.Columns("A:Q").AutoFitNext wsEnd Sub